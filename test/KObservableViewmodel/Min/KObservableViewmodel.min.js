var KObservableViewmodel=function(){var D=function(){return function(A,u,B){function q(a,e,b,d,c,g,v){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=e;this.arguments=g;this.type=b;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=d;this.oldValue=c;this.stopChange=v}function k(a,e,b,d){this.stopPropogation=function(){this._stopPropogration=!0};
this.preventDefault=function(){this._preventDefault=!0};this.type=a;this.key=e;this.event=b;this.args=d}function m(a,e){var b=r[e];return function(d,e){var g=new q(this,h(b)?d:"",a,h(b)?this[d]:"",h(b)?this[d]:"",arguments),g=new k(a,h(b)?d:"",g,arguments),v;!0!==n(g)&&(h(b)?(void 0===b[g.key]&&(b[g.key]=[]),v=b[g.key],v.push(g.args[1])):t(b)&&(void 0===b["*"]&&(b["*"]=[]),v=g.args[1]&&"*"===g.args[1]?b["*"]:b,v.push(g.args[0])));return this}}function w(a,e){var b=r[e];return function(d,e){var g=
new q(this,d,a,this[d],this[d],arguments),g=new k(a,d,g,arguments),v;if(!0!==n(g))if(h(b)){if(v=b[g.key])for(var c=0,f=v.length;c<f;c++)if(v[c].toString()===g.args[1].toString()){v.splice(c,1);break}}else if(t(b))for(void 0===b["*"]&&(b["*"]=[]),v=g.args[1]&&"*"===g.args[1]?b["*"]:b,c=0,f=v.length;c<f;c++)if(v[c].toString()===g.args[0].toString()){v.splice(c,1);break}return this}}function h(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function t(a){return"object"===
typeof a&&!!a&&a.constructor.toString()===Array.toString()}function l(a,e,b){return{get:function(){return a[e]},set:function(b){(this._stopChange?a.stopChange():a)[e]=b;this._stopChange=void 0},enumerable:b.enumerable,configurable:b.configurable}}function c(a,e,b){return{value:a,writable:!!e,enumerable:!1,configurable:!!b}}function f(a,e){var b=a,d=a;return{get:function(){return b},set:function(a){var g=new q(this,e,"set",a,b,arguments,"__kblisteners",this._stopChange);!0!==y(g)&&(d=b,b=a,g.stopChange||
(g.listener="__kbupdatelisteners",g.type="update",y(g)),this._stopChange||this.callSubscribers(e,b,d));this._stopChange=void 0},configurable:!0,enumerable:!0}}var r=[],p={},z={splice:[],postsplice:[],push:[],postpush:[],pop:[],postpop:[],shift:[],postshift:[],unshift:[],postunshift:[],fill:[],postfill:[],reverse:[],postreverse:[],sort:[],postsort:[],add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],subscribe:[],unsubscribe:[],addDataListener:[],removeDataListener:[],addDataUpdateListener:[],
removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},n=function(a){for(var e=0,b=z[a.type],d=b.length;e!==d&&(b[e](a),!a._stopPropogration);e++);return a._preventDefault},x=function(a,e){if(!e._stopPropogration&&a)for(var b=0,d=a.length;b!==d&&(a[b](e),!e._stopPropogration);b++);},y=function(a){var e=a.local[a.listener];h(e)?(x(e[a.key],a),"__kblisteners"===a.listener?(x(e["*"],a),a.fromListener="__kblisteners",a.listener=
"__kbparentlisteners",x(a.local[a.listener][a.key],a),x(a.local[a.listener]["*"],a)):"__kbupdatelisteners"===a.listener&&(x(e["*"],a),a.fromListener="__kbupdatelisteners",a.listener="__kbparentupdatelisteners",x(a.local[a.listener][a.key],a),x(a.local[a.listener]["*"],a))):t(e)&&(x(e,a),x(e["*"],a));return a._preventDefault};Object.defineProperties(r,{__kbname:c(A||"",!0,!0),__kbref:c(u?u.__kbref||u:r,!0,!0),__kbscopeString:c(B||"",!0,!0),__kbImmediateParent:c(u||null,!0,!0),splice:c(function(a,e,
b){var d=new q(this,a,"splice",this[a],void 0,arguments,"__kbdatadeletelisteners"),c=new k("splice",a,d,arguments);if(!0!==n(c)){var g=[],v=Array.prototype.slice.call(arguments),h=v.length-2,m=0;v.splice(0,2);if(0!==e&&void 0!==this[c.key-1+c.args[1]])for(var l=0,w=c.args[1];l<w;l++)if(m=c.key,d.key=m,d.type="remove",d.value=this[m],c.type="remove",!0!==n(c)&&!0!==y(d)){g.push(this[m]);for(var p=c.key,r=this.length-1;p<r;p++)this[p]=this[p+1];--this.length;c.type="postremove";n(c)}else--c.args[1];
if(0!==h)for(l=0,w=h;l<w;l++)if(m=c.key+Math.min(1,l),d.key=m,d.type="add",d.listener="__kbdatacreatelisteners",d.value=v[l],c.type="add",c.key=m,!0!==n(c)&&!0!==y(d)){p=this.length;for(r=m;p>r;p--)void 0===this[p]?(Object.defineProperty(this,p,f.call(this,this[p-1],p)),c.key=p,c.type="postadd",n(c)):this[p]=this[p-1];this[m]=v[l]}c.type="postsplice";n(c)}return g}),push:c(function(a){var e=new q(this,this.length,"push",a,void 0,arguments,"__kbdatacreatelisteners"),b=new k("push",this.length,e,arguments);
!0!==n(b)&&(e.type="add",e.value=b.args[0],e.key=b.key,b.type="add",!0!==n(b)&&!0!==y(e)&&(Object.defineProperty(this,b.key,f.call(this,b.args[0],b.key)),b.type="postadd",n(b),b.type="postpush",n(b)));return this.length}),pop:c(function(){var a=new q(this,this.length-1,"pop",this[this.length-1],void 0,arguments,"__kbdatadeletelisteners"),e=new k("pop",this.length-1,a,arguments);if(!0!==n(e)){var b=this[this.length-1];a.type="remove";e.type="remove";if(!0!==n(e)&&!0!==y(a))return--this.length,e.type=
"postremove",n(e),e.type="postpop",n(e),b}return null}),shift:c(function(){var a=new q(this,0,"shift",this[0],void 0,arguments,"__kbdatadeletelisteners"),e=new k("shift",0,a,arguments);if(!0!==n(e)){var b=this[e.key];a.type="remove";a.key=e.key;e.type="remove";if(!0!==n(e)&&!0!==y(a)){for(var a=e.key,d=this.length-1;a<d;a++)this[a]=this[a+1];--this.length;e.type="postremove";n(e);e.type="postshift";n(e);return b}}return null}),unshift:c(function(){var a=new q(this,0,"unshift",this[0],void 0,arguments,
"__kbdatacreatelisteners"),e=new k("unshift",0,a,arguments);if(!0!==n(e)){for(var b=Array.prototype.slice.call(e.args),d=0,c=b.length;d<c;d++)a.key=d,a.type="add",a.value=b[d],e.type="add",e.key=d,!0!==n(e)&&!0!==y(a)||b.splice(d,1);if(0!==b.length){d=this.length-1+b.length;for(c=b.length;-1!==d;d--)d<c?this[d]=b[d]:void 0!==Object.getOwnPropertyDescriptor(this,d).value?(Object.defineProperty(this,d,f.call(this,this[d-b.length],d)),e.type="postadd",n(e)):this[d]=this[d-b.length];e.type="postunshift";
n(e)}}return this.length}),fill:c(function(a,e,b){var d=void 0!==e?Math.max(0,e):0,c=new q(this,d,"fill",a,this[d],arguments,"__kbdatalisteners"),d=new k("fill",d,c,arguments);if(!0!==n(d)){for(c=d.key;c<d.args[2];c++)this[c]=d.args[0];d.type="postfill";n(d)}return this}),reverse:c(function(){var a=new q(this,0,"reverse",value,this[_start],arguments,"__kbdatalisteners"),a=new k("reverse",0,a,arguments);if(!0!==n(a)){for(var e=this.slice().reverse(),b=0,d=this.length;b<d;b++)this[b]=e[b];a.type="postreverse";
n(a)}return this}),sort:c(function(){var a=new q(this,0,"sort",value,this[_start],arguments,"__kbdatalisteners"),a=new k("sort",0,a,arguments);if(!0!==n(a)){for(var e=this.slice(),e=e.sort.apply(e,arguments),b=0,d=this.length;b<d;b++)this[b]=e[b];a.type="postsort";n(a)}return this}),add:c(function(a,e){var b=new q(this,a,"add",e,void 0,arguments,"__kbdatacreatelisteners"),d=new k("add",a,b,arguments);void 0===e?this.push(a):!0!==n(d)&&(void 0===this[d.key]?!0!==y(b)&&(Object.defineProperty(this,d.key,
f.call(this,d.args[1],d.key)),d.type="postadd",n(d)):console.error("Your attempting to add the index: ",d.key," that already exists on",this,"try using set or direct set instead"));return this}),prototype:c(function(a,e){void 0===this[a]?Object.defineProperty(this.__proto__,a,c(e,!0,!0)):console.error("Your attempting to add your prototype with the prop: ",a," that already exists");return this}),addPointer:c(function(a,e,b){var d=new q(this,b||e,"add",a[e],void 0,arguments,"__kbdatacreatelisteners"),
c=new k("add",b||e,d,arguments);!0!==n(c)&&!0!==y(d)&&(d=Object.getOwnPropertyDescriptor(a,e),Object.defineProperty(this,c.key,l(a,e,d)),c.type="postadd",n(c));return this}),set:c(function(a,e){var b=new q(this,a,"set",e,this[a],arguments,"__kblisteners"),d=new k("set",a,b,arguments);void 0===this[a]?this.add(a,e):!0!==n(d)&&(b.key=d.key,b.value=d.args[1],!0!==y(b)&&(void 0===Object.getOwnPropertyDescriptor(this,d.key).value?this[d.key]=d.args[1]:Object.defineProperty(this,d.key,f.call(this,d.args[1],
d.key)),d.type="postset",n(d)));return this}),remove:c(function(a,e){var b=new q(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),b=new k("remove",a,b,arguments);if(!0!==n(b)){if(void 0===this[b.key])return console.error("Your attempting to remove the index: ",b.key," that does not exist on ",this),this;this.splice(b.key,b.args[1])}return this}),stringify:c(function(){var a=[];return JSON.stringify(this,function(e,b){if(t(b)||h(b)){if(-1!==a.indexOf(b))return;a.push(b)}return b})}),
callSubscribers:c(function(a,e,b){if(void 0!==p[a])for(var d=0,c=p[a].length;d<c;d++)p[a][d](a,e,b);if(void 0!==p["*"])for(d=0,c=p["*"].length;d<c;d++)p["*"][d](a,e,b);return this}),subscribe:c(function(a,e){var b=new q(this,a,"subscribe",this[a],void 0,arguments),b=new k("subscribe",a,b,arguments);!0!==n(b)&&(void 0===p[b.key]&&(p[b.key]=[]),p[b.key].push(e));return this}),unsubscribe:c(function(a,e){var b=new q(this,a,"unsubscribe",this[a],void 0,arguments),b=new k("unsubscribe",a,b,arguments);
if(!0!==n(b)&&void 0!==p[b.key]){var d=0,c=p[b.key].length;a:for(;d<c;d++)if(p[b.key][d].toString()===e.toString()){p[b.key].splice(d,1);break a}}return this}),__kblisteners:c({}),__kbupdatelisteners:c({}),__kbparentlisteners:c({}),__kbparentupdatelisteners:c({}),__kbdatacreatelisteners:c([]),__kbdatadeletelisteners:c([]),addActionListener:c(function(a,e){-1!==Object.keys(z).indexOf(a)?z[a].push(e):console.error("There is no action listener by the name: ",a);return this}),removeActionListener:c(function(a,
e){if(-1!==Object.keys(z).indexOf(a))for(var b=0,d=z[a],c=d.length;b!==c;b++){if(d[b].toString()===e.toString()){d.splice(b,1);break}}else console.error("There is no action listener by the name: ",a);return this}),stopChange:c(function(){this._stopChange=!0;return this}),_stopChange:c(void 0,!0)});Object.defineProperties(r,{addDataListener:c(m("addDataListener","__kblisteners")),removeDataListener:c(w("removeDataListener","__kblisteners")),addDataUpdateListener:c(m("addDataUpdateListener","__kbupdatelisteners")),
removeDataUpdateListener:c(w("removeDataUpdateListener","__kbupdatelisteners")),addDataCreateListener:c(m("addDataCreateListener","__kbdatacreatelisteners")),removeDataCreateListener:c(w("addDataCreateListener","__kbdatacreatelisteners")),addDataRemoveListener:c(m("addDataRemoveListener","__kbdatadeletelisteners")),removeDataRemoveListener:c(w("removeDataRemoveListener","__kbdatadeletelisteners"))});return r}}(),E=function(){return function(A,u,B){function q(a,e,b,d,c,g,v,h){this.stopPropogation=
function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=e;this.arguments=g;this.type=b;this.listener=v;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=d;this.oldValue=c;this.stopChange=h}function k(a,e,b,d){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.type=a;this.key=e;this.event=b;this.args=d}function m(a,
e){var b=r[e];return function(d,e){var g=new q(this,h(b)?d:"",a,h(b)?this[d]:"",h(b)?this[d]:"",arguments),g=new k(a,h(b)?d:"",g,arguments),c;!0!==n(g)&&(h(b)?(void 0===b[g.key]&&(b[g.key]=[]),c=b[g.key],c.push(g.args[1])):t(b)&&(void 0===b["*"]&&(b["*"]=[]),c=g.args[1]&&"*"===g.args[1]?b["*"]:b,c.push(g.args[0])));return this}}function w(a,e){var b=r[e];return function(d,e){var g=new q(this,d,a,this[d],this[d],arguments),g=new k(a,d,g,arguments),c;if(!0!==n(g))if(h(b)){if(c=b[g.key])for(var f=0,
m=c.length;f<m;f++)if(c[f].toString()===g.args[1].toString()){c.splice(f,1);break}}else if(t(b))for(void 0===b["*"]&&(b["*"]=[]),c=g.args[1]&&"*"===g.args[1]?b["*"]:b,f=0,m=c.length;f<m;f++)if(c[f].toString()===g.args[0].toString()){c.splice(f,1);break}return this}}function h(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function t(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Array.toString()}function l(a,e,b){return{get:function(){return a[e]},set:function(b){(this._stopChange?
a.stopChange():a)[e]=b;this._stopChange=void 0},enumerable:b.enumerable,configurable:b.configurable}}function c(a,e,b){return{value:a,writable:!!e,enumerable:!1,configurable:!!b}}function f(a,e){var b=a,d=a;return{get:function(){return b},set:function(a){var g=new q(this,e,"set",a,b,arguments,"__kblisteners",this._stopChange);!0!==y(g)&&(d=b,b=a,g.stopChange||(g.listener="__kbupdatelisteners",g.type="update",y(g)),this._stopChange||this.callSubscribers(e,b,d));this._stopChange=void 0},configurable:!0,
enumerable:!0}}var r={},p={},z={add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],subscribe:[],unsubscribe:[],addDataListener:[],removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},n=function(a){for(var e=0,b=z[a.type],d=b.length;e!==d&&(b[e](a),!a._stopPropogration);e++);return a._preventDefault},x=function(a,e){if(!e._stopPropogration&&a)for(var b=0,d=a.length;b!==
d&&(a[b](e),!e._stopPropogration);b++);},y=function(a){var e=a.local[a.listener];h(e)?(x(e[a.key],a),"__kblisteners"===a.listener?(x(e["*"],a),a.fromListener="__kblisteners",a.listener="__kbparentlisteners",x(a.local[a.listener][a.key],a),x(a.local[a.listener]["*"],a)):"__kbupdatelisteners"===a.listener&&(x(e["*"],a),a.fromListener="__kbupdatelisteners",a.listener="__kbparentupdatelisteners",x(a.local[a.listener][a.key],a),x(a.local[a.listener]["*"],a))):t(e)&&(x(e,a),x(e["*"],a));return a._preventDefault};
Object.defineProperties(r,{__kbname:c(A||"",!0,!0),__kbref:c(u?u.__kbref||u:r,!0,!0),__kbscopeString:c(B||"",!0,!0),__kbImmediateParent:c(u||null,!0,!0),add:c(function(a,e){var b=new q(this,a,"add",e,void 0,arguments,"__kbdatacreatelisteners"),d=new k("add",a,b,arguments);!0!==n(d)&&(void 0===this[d.key]?!0!==y(b)&&(Object.defineProperty(this,d.key,f.call(this,d.args[1],d.key)),d.type="postadd",n(d)):console.error("Your attempting to add the property: ",d.key," that already exists on",this,"try using set or direct set instead"));
return this}),addPointer:c(function(a,e,b){var d=new q(this,b||e,"add",a[e],void 0,arguments,"__kbdatacreatelisteners"),c=new k("add",b||e,d,arguments);!0!==n(c)&&!0!==y(d)&&(d=Object.getOwnPropertyDescriptor(a,e),Object.defineProperty(this,c.key,l(a,e,d)),c.type="postadd",n(c));return this}),prototype:c(function(a,e){void 0===this[a]?Object.defineProperty(this.__proto__,a,c(e,!0,!0)):console.error("Your attempting to add the your method with the prop: ",a," that already exists");return this}),set:c(function(a,
e){var b=new q(this,a,"set",e,this[a],arguments,"__kblisteners"),d=new k("set",a,b,arguments);void 0===this[a]?this.add(d.key,d.args[1]):!0!==n(d)&&(b.key=d.key,b.value=d.args[1],!0!==y(b)&&(void 0===Object.getOwnPropertyDescriptor(this,d.key).value?this[d.key]=d.args[1]:Object.defineProperty(this,d.key,f.call(this,d.args[1],d.key)),d.type="postset",n(d)));return this}),remove:c(function(a){var e=new q(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),b=new k("remove",a,e,arguments);
if(!0!==n(b)){if(void 0===this[b.key])return console.error("Your attempting to remove the property: ",b.key," that does not exist on ",this),this;!0!==y(e)&&(Object.defineProperty(this,b.key,{value:null,writable:!0,enumerable:!0,configurable:!0}),b.type="postremove",n(b))}return this}),stringify:c(function(){var a=[];return JSON.stringify(this,function(e,b){if(t(b)||h(b)){if(-1!==a.indexOf(b))return;a.push(b)}return b})}),callSubscribers:c(function(a,e,b){if(void 0!==p[a])for(var d=0,c=p[a].length;d<
c;d++)p[a][d](a,e,b);if(void 0!==p["*"])for(d=0,c=p["*"].length;d<c;d++)p["*"][d](a,e,b);return this}),subscribe:c(function(a,c){var b=new q(this,a,"subscribe",this[a],void 0,arguments),b=new k("subscribe",a,b,arguments);!0!==n(b)&&(void 0===p[b.key]&&(p[b.key]=[]),p[b.key].push(c));return this}),unsubscribe:c(function(a,c){var b=new q(this,a,"unsubscribe",this[a],void 0,arguments),b=new k("unsubscribe",a,b,arguments);if(!0!==n(b)&&void 0!==p[b.key]){var d=0,h=p[b.key].length;a:for(;d<h;d++)if(p[b.key][d].toString()===
c.toString()){p[b.key].splice(d,1);break a}}return this}),__kblisteners:c({}),__kbupdatelisteners:c({}),__kbparentlisteners:c({}),__kbparentupdatelisteners:c({}),__kbdatacreatelisteners:c([]),__kbdatadeletelisteners:c([]),addActionListener:c(function(a,c){-1!==Object.keys(z).indexOf(a)?z[a].push(c):console.error("There is no action listener by the name: ",a);return this}),removeActionListener:c(function(a,c){if(-1!==Object.keys(z).indexOf(a))for(var b=0,d=z[a],h=d.length;b!==h;b++){if(d[b].toString()===
c.toString()){d.splice(b,1);break}}else console.error("There is no action listener by the name: ",a);return this}),onadd:c(function(){},!0),onremove:c(function(){},!0),onset:c(function(){},!0),onupdate:c(function(){},!0),stopChange:c(function(){this._stopChange=!0;return this}),_stopChange:c(void 0,!0)});Object.defineProperties(r,{addDataListener:c(m("addDataListener","__kblisteners")),removeDataListener:c(w("removeDataListener","__kblisteners")),addDataUpdateListener:c(m("addDataUpdateListener",
"__kbupdatelisteners")),removeDataUpdateListener:c(w("removeDataUpdateListener","__kbupdatelisteners")),addDataCreateListener:c(m("addDataCreateListener","__kbdatacreatelisteners")),removeDataCreateListener:c(w("removeDataCreateListener","__kbdatacreatelisteners")),addDataRemoveListener:c(m("addDataRemoveListener","__kbdatadeletelisteners")),removeDataRemoveListener:c(w("removeDataRemoveListener","__kbdatadeletelisteners"))});return r}}(),C=function(A){return function(){function u(m,w,h,k){var l=
m.tagName.toLowerCase();void 0===w&&(w=[]);void 0===h&&(h={});h.filters||(h.filters={});h.sessionStorage||(h.sessionStorage=!1);h.localStorage||(h.localStorage=!1);h.store||(h.store=!1);h.multiple||(h.multiple=!1);void 0===k&&(k={});var c=[];void 0!==m.kb_maps&&(c=m.kb_maps.map(function(c){return c.prop}));for(var f=0,q=m.attributes.length;f<q;f++){var p=m.attributes[f].name,z=c.indexOf(p);k[p]=-1!==z?m.kb_mapper.kb_viewmodel.getScope(Object.keys(m.kb_maps[z].binds)[0].key):m.getAttribute(p)}return u.createViewModel(l,
w,h,k)}var B=A("Model"),q={},k="id filters class sessionStorage localStorage store component".split(" ");u.ignore=function(m){-1===k.indexOf(m)&&k.push(m);return this};u.unignore=function(m){-1!==k.indexOf(m)&&k.splice(k.indexOf(m),1);return this};u.createViewModel=function(m,k,h,t){if(u.isRegistered(m)){var l=A(m),c=q[m];l.__proto__=void 0!==c.prototype?c.prototype:c.__proto__;if(h){var f=0;h=Object.keys(h);for(var r=h.length;f<r;f++)l.isObservable(t,h[f])?l.addPointer(t,h[f]):l.add(h[f],t[h[f]])}if("function"===
typeof c)for(c.apply(l,k),f=0,h=Object.keys(l),r=h.length;f<r;f++)l.isObservable(l,h[f])||l.set(h[f],l[h[f]]);else for(f=0,h=Object.keys(c),r=h.length;f<r;f++)l.isObservable(c,h[f])?(l[h[f]]&&l.remove(h[f]),l.addPointer(c,h[f])):l.set(h[f],c[h[f]]);if(t)for(f=0,h=Object.keys(t),r=h.length;f<r;f++)l.isObservable(t,h[f])?(k=function(c){t[c.type]&&t[c.type].apply(t,c.args)},void 0!==l[h[f]]&&l.remove(h[f]),l.addPointer(t,h[f]),l.addActionListener("addDataListener",k).addActionListener("addDataUpdateListener",
k).addActionListener("addDataCreateListener",k).addActionListener("addDataRemoveListener",k).addActionListener("removeDataListener",k).addActionListener("removeDataUpdateListener",k).addActionListener("removeDataCreateListener",k).addActionListener("removeDataRemoveListener",k)):l.set(h[f],t[h[f]]);if(l.sessionStorage){if(k=sessionStorage.getItem(l.id||m))for(k=JSON.parse(k),f=0,h=Object.keys(k),r=h.length;f<r;f++)l.set(h[f],k[h[f]]);else sessionStorage.setItem(l.id||m,l.stringify());l.addChildDataUpdateListener("*",
function(){sessionStorage.setItem(l.id||m,l.stringify())})}if(l.localStorage){if(k=localStorage.getItem(l.id||m))for(k=JSON.parse(k),f=0,h=Object.keys(k),r=h.length;f<r;f++)l.set(h[f],k[h[f]]);else localStorage.setItem(l.id||m,l.stringify());l.addChildDataUpdateListener("*",function(){localStorage.setItem(l.id||m,l.stringify())})}l.store&&B.set(l.id||m,l);return l}console.error("There is no viewmodel by the name %o",m);return null};u.isRegistered=function(m){return void 0!==q[m]};u.register=function(m,
k){q[m]=k;return this};u.model=function(k){return k?B[k]:B};return u}}(function(A,u){return function(B,q){function k(a){return"[object Array]"===Object.prototype.toString.call(a)}function m(a){return"[object Object]"===Object.prototype.toString.call(a)}function w(a,b){return b?a[b]?void 0===Object.getOwnPropertyDescriptor(a,b).value:!1:void 0!==a.__kbname}function h(a,b,c,d){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.type=
a;this.key=b;this.event=c;this.args=d}function t(a){return a.split(".").filter(function(a){return 0!==a.length})}function l(a,b){function c(a){b.splice(0,1);return 0===b.length?a:a[b[0]]?c(a[b[0]]):a}return(b=t(b))&&1!==b.length?c(a[b[0]]):b&&b.length?a[b[0]]:a}function c(a,b,c){function d(a){b.splice(0,1);1===b.length?a[b[0]]=c:d(a[b[0]])}(b=t(b))&&1!==b.length?d(a[b[0]]):b&&b.length&&(a[b[0]]=c);return this}function f(a){var b=a.key.split(".");if(1===b.length&&"*"!==a.key)return!1;"*"!==a.key?(a.preventDefault(),
l(a.event.local,b.slice(0,b.length-1).join("."))[a.type](b[b.length-1],a.args[1])):(a.preventDefault(),-1!==a.type.toLowerCase().indexOf("update")?a.event.local.addChildDataUpdateListener("*",a.args[1]):a.event.local.addChildDataListener("*",a.args[1]))}function r(a){var b=a.key.split(".");if(1===b.length&&"*"!==a.key)return!1;if("*"!==a.key)a.preventDefault(),l(a.event.local,b.slice(0,b.length-1).join("."))[a.type](b[b.length-1],a.args[1]);else for(var b=Object.keys(a.event.local).filter(function(b){return m(a.event.local[b])||
k(a.event.local[b])}),c=0,d=b.length;c<d;c++)a.event.local[b[c]].subscribe(a.key,a.args[1])}function p(g){void 0===g.parseData&&g.prototype("parseData",d);void 0===g.isArray&&g.prototype("isArray",k);void 0===g.isObject&&g.prototype("isObject",m);void 0===g.isObservable&&g.prototype("isObservable",w);void 0===g.updateName&&g.prototype("updateName",x);void 0===g.getScopeByScopeString&&g.prototype("getScopeByScopeString",l);void 0===g.setScopeByScopeString&&g.prototype("setScopeByScopeString",c);void 0===
g.addChildDataListener&&g.prototype("addChildDataListener",z("__kbparentlisteners"));void 0===g.removeChildDataListener&&g.prototype("removeChildDataListener",n("__kbparentlisteners"));void 0===g.addChildDataUpdateListener&&g.prototype("addChildDataUpdateListener",z("__kbparentupdatelisteners"));void 0===g.removeChildDataUpdateListener&&g.prototype("removeChildDataUpdateListener",n("__kbparentupdatelisteners"));void 0===g.setUnobservable&&g.prototype("setUnobservable",y);void 0===g.addUnobservable&&
g.prototype("addUnobservable",a);return g.addActionListener("add",e).addActionListener("set",b).addActionListener("subscribe",r).addActionListener("unsubscribe",r).addActionListener("addDataListener",f).addActionListener("addDataUpdateListener",f).addActionListener("addDataCreateListener",f).addActionListener("addDataRemoveListener",f).addActionListener("removeDataListener",f).addActionListener("removeDataUpdateListener",f).addActionListener("removeDataCreateListener",f).addActionListener("removeDataRemoveListener",
f).addDataUpdateListener("*",function(a){this._stopChange?this._stopChange=!1:b(new h("set",a.key,a,[a.value]))})}function z(a){return function(b,c){function d(b,c,e){var h=Object.keys(b).filter(function(a){return m(b[a])||k(b[a])});void 0===b[a][c]&&(b[a][c]=[]);b[a][c].push(e);for(var f=0,l=h.length;f<l;f++)d(b[h[f]],c,e)}d(this,b,c);return this}}function n(a){return function(b,c){function d(b,c,e){var h=Object.keys(b).filter(function(a){return m(b[a])||k(b[a])}),f=0,l=b[a][c].length;a:for(;f<l;f++)if(b[a][c][f].toString()===
e.toString()){b[a][c].splice(f,1);break a}f=0;for(l=h.length;f<l;f++)d(b[h[f]],c,e)}d(this,b,c);return this}}function x(a){"string"===typeof a&&(C.name=a);return this}function y(a,b){this.stopChange()[a]=b;return this}function a(a,b){void 0===this[a]?this[a]=b:console.error("")}function e(a){if((m(a.event.value)||k(a.event.value))&&!w(a.event.value)){a.preventDefault();var b=a.event.local,c=b.__kbscopeString+(0!==b.__kbscopeString.length?".":"")+a.key,c=(m(a.event.value)?u:A)(b.__kbname,b,c);p(c).parseData(a.event.value);
void 0===b[a.key]?b.add(a.key,c):k(b)?b.splice(a.key,0,c):m(b)&&b.set(a.key,c)}}function b(a){if((m(a.event.value)||k(a.event.value))&&!w(a.event.value)){a.preventDefault();var b=a.event.local,c=b.__kbscopeString+(0!==b.__kbscopeString.length?".":"")+a.key,c=(m(a.event.value)?u:A)(b.__kbname,b,c);p(c).parseData(a.event.value);b.set(a.key,c)}}function d(a){for(var b=0,c=Object.keys(a),d=c.length;b<d;b++)this.set(c[b],a[c[b]]);return this}var C={name:B};_data=("string"===typeof q&&"array"===q.toLowercase()?
A:u)(C.name,void 0,"").addPointer(C,"name","__kbname");p(_data);return _data}}(D,E));window.define&&window.require?define([],function(){return C}):window.module&&(module.exports=C);return C}();
